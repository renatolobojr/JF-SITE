<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AjudaJF â€” Central de Solidariedade Â· Juiz de Fora</title>
  <meta name="description" content="Central de solidariedade para famÃ­lias atingidas pelas chuvas em Juiz de Fora, MG. Pedidos de ajuda, voluntÃ¡rios e pontos de doaÃ§Ã£o.">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,600;0,700;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --cream:      #FAF7F2;
      --warm-white: #FFFEFB;
      --clay:       #C4714A;
      --clay-light: #E8956F;
      --clay-dark:  #A05438;
      --sand:       #E8DDD0;
      --sand-dark:  #D4C5B2;
      --earth:      #6B4F3A;
      --earth-light:#8C6F5A;
      --moss:       #4A7A5C;
      --moss-light: #EBF5EF;
      --moss-dark:  #345C42;
      --sky:        #4A7C9E;
      --sky-light:  #EFF6FB;
      --sky-dark:   #2E5F7A;
      --text:       #2C1F17;
      --text-muted: #7A6155;
      --border:     rgba(196,113,74,.15);
      --shadow:     0 4px 32px rgba(100,60,30,.10);
      --shadow-sm:  0 2px 12px rgba(100,60,30,.07);
      --radius:     20px;
      --radius-sm:  14px;
    }

    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'DM Sans', system-ui, sans-serif;
      background: var(--cream);
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 48px 20px 64px;
    }

    /* â”€â”€ AVATAR / LOGO â”€â”€ */
    .avatar {
      width: 80px; height: 80px; border-radius: 50%;
      background: linear-gradient(135deg, var(--clay) 0%, var(--clay-dark) 100%);
      display: flex; align-items: center; justify-content: center;
      font-size: 36px; margin-bottom: 16px;
      box-shadow: 0 4px 20px rgba(196,113,74,.35);
    }

    /* â”€â”€ BADGE ATIVO â”€â”€ */
    .badge {
      display: inline-flex; align-items: center; gap: 7px;
      background: #FFF0E8; border: 1px solid #F0C4AB;
      color: var(--clay-dark); font-size: 12px; font-weight: 600;
      padding: 5px 12px; border-radius: 999px; margin-bottom: 14px;
    }
    .pulse-dot {
      width: 7px; height: 7px; border-radius: 50%;
      background: var(--clay); animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0%,100% { opacity:1; transform:scale(1); }
      50%      { opacity:.5; transform:scale(.8); }
    }

    /* â”€â”€ TÃTULOS â”€â”€ */
    h1 {
      font-family: 'Lora', serif; font-weight: 700;
      font-size: 28px; line-height: 1.2; letter-spacing: -.02em;
      color: var(--earth); text-align: center; margin-bottom: 8px;
    }
    h1 em { color: var(--clay); font-style: italic; }
    .subtitle {
      font-size: 14px; color: var(--text-muted);
      text-align: center; max-width: 320px; line-height: 1.55;
      margin-bottom: 36px;
    }

    /* â”€â”€ SEÃ‡ÃƒO â”€â”€ */
    .section-label {
      font-size: 11px; font-weight: 700; letter-spacing: .08em;
      text-transform: uppercase; color: var(--text-muted);
      margin-bottom: 12px; align-self: flex-start;
      width: 100%; max-width: 400px;
    }

    /* â”€â”€ CARDS PRINCIPAIS â”€â”€ */
    .links-group {
      display: flex; flex-direction: column; gap: 12px;
      width: 100%; max-width: 400px; margin-bottom: 10px;
    }

    .link-card {
      display: flex; align-items: center; gap: 16px;
      padding: 16px 20px; border-radius: var(--radius);
      border: 1.5px solid var(--border);
      background: var(--warm-white);
      box-shadow: var(--shadow-sm);
      text-decoration: none; color: var(--text);
      transition: transform .15s, box-shadow .15s, border-color .15s;
      cursor: pointer;
    }
    .link-card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
      border-color: var(--sand-dark);
    }
    .link-card:active { transform: translateY(0); }

    .link-card.clay  { border-left: 4px solid var(--clay); }
    .link-card.moss  { border-left: 4px solid var(--moss); }

    .card-icon {
      width: 44px; height: 44px; border-radius: 14px;
      display: flex; align-items: center; justify-content: center;
      font-size: 22px; flex-shrink: 0;
    }
    .card-icon.orange { background: #FFF0E8; }
    .card-icon.green  { background: var(--moss-light); }

    .card-text { flex: 1; }
    .card-title {
      font-family: 'Lora', serif; font-weight: 700;
      font-size: 16px; color: var(--earth); margin-bottom: 2px;
    }
    .card-desc { font-size: 12px; color: var(--text-muted); line-height: 1.4; }

    .card-arrow {
      font-size: 18px; color: var(--sand-dark);
      transition: transform .15s, color .15s;
    }
    .link-card:hover .card-arrow { transform: translateX(3px); color: var(--clay); }
    .link-card.moss:hover  .card-arrow { color: var(--moss); }
    .link-card.danger:hover .card-arrow { color: var(--danger); }
    .link-card.sky:hover   .card-arrow { color: var(--sky-dark); }
    .link-card.danger { border-left: 4px solid var(--danger); }
    .link-card.sky    { border-left: 4px solid #2563EB; }
    .card-icon.red    { background: var(--danger-bg); }
    .card-icon.blue   { background: #EFF6FF; }

    /* â”€â”€ CONTADOR â”€â”€ */
    .counter-row {
      display: flex; gap: 8px; margin-bottom: 36px;
      width: 100%; max-width: 400px;
    }
    .counter-pill {
      flex: 1; background: var(--warm-white); border: 1px solid var(--border);
      border-radius: var(--radius-sm); padding: 10px 12px; text-align: center;
      box-shadow: var(--shadow-sm);
    }
    .counter-num {
      font-family: 'Lora', serif; font-weight: 700;
      font-size: 22px; color: var(--earth); display: block;
      min-height: 28px;
    }
    .counter-num.loading { color: var(--sand-dark); font-size: 14px; padding-top: 4px; }
    .counter-label { font-size: 11px; color: var(--text-muted); margin-top: 2px; }

    /* â”€â”€ PARCEIROS â”€â”€ */
    .partners-group {
      display: flex; flex-direction: column; gap: 10px;
      width: 100%; max-width: 400px; margin-bottom: 36px;
    }

    .partner-card {
      display: flex; align-items: center; gap: 14px;
      padding: 13px 16px; border-radius: var(--radius-sm);
      border: 1px solid var(--border); background: var(--warm-white);
      box-shadow: var(--shadow-sm); text-decoration: none; color: var(--text);
      transition: transform .15s, box-shadow .15s, border-color .15s;
    }
    .partner-card:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow);
      border-color: var(--sand-dark);
    }
    .partner-icon {
      width: 36px; height: 36px; border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 18px; flex-shrink: 0; background: var(--sky-light);
    }
    .partner-text { flex: 1; }
    .partner-name { font-size: 14px; font-weight: 600; color: var(--earth); }
    .partner-url  { font-size: 11px; color: var(--text-muted); margin-top: 1px; }
    .partner-ext  { font-size: 13px; color: var(--sand-dark); }

    /* â”€â”€ DIVIDER â”€â”€ */
    .divider {
      width: 100%; max-width: 400px;
      height: 1px; background: var(--border);
      margin: 8px 0 24px;
    }

    /* â”€â”€ FOOTER â”€â”€ */
    .footer {
      margin-top: auto; padding-top: 40px;
      font-size: 12px; color: var(--text-muted);
      text-align: center; line-height: 1.7;
    }
    .footer a { color: var(--clay); text-decoration: underline; }
    .emergency {
      display: inline-flex; gap: 16px; flex-wrap: wrap; justify-content: center;
      background: var(--warm-white); border: 1px solid var(--border);
      border-radius: var(--radius-sm); padding: 10px 16px;
      font-size: 13px; font-weight: 600; color: var(--earth);
      margin-bottom: 16px;
    }

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       SPLASH SCREEN
    â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    #splash {
      position: fixed; inset: 0; z-index: 9999;
      background: linear-gradient(160deg, #FAF7F2 0%, #F0E8DF 100%);
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      gap: 0;
      transition: opacity .5s ease, visibility .5s ease;
    }
    #splash.hidden {
      opacity: 0; visibility: hidden; pointer-events: none;
    }

    /* Logo pulsante */
    .splash-logo {
      width: 96px; height: 96px; border-radius: 50%;
      background: linear-gradient(135deg, var(--clay) 0%, var(--clay-dark) 100%);
      display: flex; align-items: center; justify-content: center;
      font-size: 44px;
      box-shadow: 0 8px 40px rgba(196,113,74,.4);
      animation: splashPop .6s cubic-bezier(.34,1.56,.64,1) both,
                 splashFloat 3s ease-in-out 0.6s infinite;
      margin-bottom: 28px;
    }
    @keyframes splashPop {
      from { opacity: 0; transform: scale(.4); }
      to   { opacity: 1; transform: scale(1); }
    }
    @keyframes splashFloat {
      0%,100% { transform: translateY(0); }
      50%      { transform: translateY(-8px); }
    }

    /* Nome */
    .splash-title {
      font-family: 'Lora', serif; font-weight: 700;
      font-size: 32px; letter-spacing: -.02em;
      color: var(--earth); margin-bottom: 4px;
      animation: splashFade .5s ease .3s both;
    }
    .splash-title em { color: var(--clay); font-style: italic; }

    .splash-sub {
      font-size: 13px; color: var(--text-muted);
      animation: splashFade .5s ease .45s both;
      margin-bottom: 48px;
    }
    @keyframes splashFade {
      from { opacity: 0; transform: translateY(8px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* Barra de progresso */
    .splash-bar-wrap {
      width: 200px; height: 3px;
      background: var(--sand); border-radius: 99px; overflow: hidden;
      animation: splashFade .4s ease .6s both;
    }
    .splash-bar {
      height: 100%; width: 0%; border-radius: 99px;
      background: linear-gradient(90deg, var(--clay-light), var(--clay-dark));
      transition: width .35s ease;
    }

    .splash-status {
      font-size: 11px; color: var(--text-muted); margin-top: 12px;
      letter-spacing: .04em; min-height: 16px;
      animation: splashFade .4s ease .7s both;
    }

    /* Pontinhos de loading */
    .splash-dots span {
      display: inline-block; width: 6px; height: 6px; border-radius: 50%;
      background: var(--clay-light); margin: 0 3px;
      animation: dotBounce 1.2s ease-in-out infinite;
    }
    .splash-dots span:nth-child(2) { animation-delay: .15s; }
    .splash-dots span:nth-child(3) { animation-delay: .30s; }
    @keyframes dotBounce {
      0%,80%,100% { transform: scale(.6); opacity:.4; }
      40%          { transform: scale(1);  opacity:1; }
    }
  </style>
</head>

<body>

  <!-- â•â• SPLASH SCREEN â•â• -->
  <div id="splash">
    <div class="splash-logo">ğŸ¤</div>
    <div class="splash-title">AjudaJF</div>
    <div class="splash-sub">Central de Solidariedade Â· Juiz de Fora, MG</div>
    <div class="splash-bar-wrap">
      <div class="splash-bar" id="splashBar"></div>
    </div>
    <div class="splash-status splash-dots" id="splashStatus">
      <span></span><span></span><span></span>
    </div>
  </div>


  <!-- Avatar -->
  <div class="avatar">ğŸ¤</div>

  <!-- Badge -->
  <div class="badge">
    <div class="pulse-dot"></div>
    Ativo agora â€” Juiz de Fora, MG
  </div>

  <!-- TÃ­tulo -->
  <h1>AjudaJF<br><em>Central de Solidariedade</em></h1>
  <p class="subtitle">Conectando famÃ­lias atingidas pelas chuvas com voluntÃ¡rios, doaÃ§Ãµes e recursos em Juiz de Fora.</p>

  <!-- Contadores em tempo real -->
  <div class="counter-row">
    <div class="counter-pill">
      <span class="counter-num loading" id="cntRequests">â€¦</span>
      <div class="counter-label">Pedidos abertos</div>
    </div>
    <div class="counter-pill">
      <span class="counter-num loading" id="cntPoints">â€¦</span>
      <div class="counter-label">Pontos de doaÃ§Ã£o</div>
    </div>
    <div class="counter-pill">
      <span class="counter-num loading" id="cntVols">â€¦</span>
      <div class="counter-label">VoluntÃ¡rios</div>
    </div>
    <div class="counter-pill">
      <span class="counter-num loading" id="cntVis">â€¦</span>
      <div class="counter-label">Vistorias abertas</div>
    </div>
  </div>

  <!-- PÃ¡ginas do AjudaJF -->
  <p class="section-label">Acesse as plataformas</p>
  <div class="links-group">

    <a href="pedidos.html" class="link-card clay">
      <div class="card-icon orange">ğŸ™</div>
      <div class="card-text">
        <div class="card-title">Pedidos de Ajuda</div>
        <div class="card-desc">FaÃ§a check-in, veja o mapa de necessidades e pontos de doaÃ§Ã£o</div>
      </div>
      <span class="card-arrow">â€º</span>
    </a>

    <a href="voluntarios.html" class="link-card moss">
      <div class="card-icon green">ğŸ™‹</div>
      <div class="card-text">
        <div class="card-title">VoluntÃ¡rios</div>
        <div class="card-desc">Cadastre-se ou encontre voluntÃ¡rios disponÃ­veis na sua regiÃ£o</div>
      </div>
      <span class="card-arrow">â€º</span>
    </a>

    <a href="vistoria.html" class="link-card danger">
      <div class="card-icon red">ğŸš</div>
      <div class="card-text">
        <div class="card-title">Vistoria TÃ©cnica</div>
        <div class="card-desc">ImÃ³vel danificado? Solicite visita de tÃ©cnico, engenheiro ou Defesa Civil</div>
      </div>
      <span class="card-arrow">â€º</span>
    </a>

    <a href="riscos.html" class="link-card sky">
      <div class="card-icon blue">â›°</div>
      <div class="card-text">
        <div class="card-title">Ãreas de Risco GeolÃ³gico</div>
        <div class="card-desc">Mapa oficial de risco geolÃ³gico e hidrolÃ³gico de Juiz de Fora</div>
      </div>
      <span class="card-arrow">â€º</span>
    </a>

  </div>

  <div class="divider"></div>

  <!-- Sites parceiros -->
  <p class="section-label">Sites parceiros</p>
  <div class="partners-group">

    <a href="https://interdicoesjf.manus.space/" target="_blank" rel="noopener" class="partner-card">
      <div class="partner-icon">ğŸš§</div>
      <div class="partner-text">
        <div class="partner-name">InterdiÃ§Ãµes de Vias â€” JF</div>
        <div class="partner-url">interdicoesjf.manus.space</div>
      </div>
      <span class="partner-ext">â†—</span>
    </a>

    <a href="https://sosminas.growberry.com.br/" target="_blank" rel="noopener" class="partner-card">
      <div class="partner-icon">ğŸ†˜</div>
      <div class="partner-text">
        <div class="partner-name">Ajuda SolidÃ¡ria SOS Minas Gerais</div>
        <div class="partner-url">sosminas.growberry.com.br</div>
      </div>
      <span class="partner-ext">â†—</span>
    </a>

    <a href="https://www.pjf.mg.gov.br/" target="_blank" rel="noopener" class="partner-card">
      <div class="partner-icon">ğŸ›</div>
      <div class="partner-text">
        <div class="partner-name">Prefeitura de Juiz de Fora</div>
        <div class="partner-url">pjf.mg.gov.br</div>
      </div>
      <span class="partner-ext">â†—</span>
    </a>

  </div>

  <!-- EmergÃªncia -->
  <div class="emergency">
    âš ï¸ Risco de vida?
    <span>Defesa Civil <strong>199</strong></span>
    <span>Bombeiros <strong>193</strong></span>
    <span>SAMU <strong>192</strong></span>
  </div>

  <!-- Footer -->
  <div class="footer">
    Desenvolvido por <a href="https://www.linkedin.com/in/jonathan-coelho-06a91014b/" target="_blank" rel="noopener">Jonathan Coelho</a><br>
    Dados via Google Sheets â€¢ Use com responsabilidade
  </div>

</body>

<script>
  /* =====================================================
     CONFIG â€” mesma URL do Apps Script
  ===================================================== */
  const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwXjWoPo48vMVLNb_bccZsdhcQ9Rg260-xr_nzc6yZT5387dcTOqiv2wi5PHmoF03Dv/exec";

  /* =====================================================
     JSONP helper
  ===================================================== */
  function jsonp(url) {
    return new Promise((resolve, reject) => {
      const cb = "cb_" + Math.random().toString(36).slice(2);
      window[cb] = (data) => { resolve(data); cleanup(); };
      const s = document.createElement("script");
      s.src = url + (url.includes("?") ? "&" : "?") + "callback=" + cb;
      s.onerror = () => { reject(new Error("falha")); cleanup(); };
      document.body.appendChild(s);
      function cleanup() { delete window[cb]; s.remove(); }
    });
  }

  /* =====================================================
     PREFETCH â€” carrega dados das outras pÃ¡ginas em
     background e salva no sessionStorage para que
     pedidos.html e voluntarios.html nÃ£o precisem
     fazer novas requisiÃ§Ãµes ao abrir
  ===================================================== */

  /* =====================================================
     SPLASH â€” controla progresso e dispensa a tela
  ===================================================== */
  const SPLASH_MAX_MS = 5000; // tempo mÃ¡ximo mesmo sem dados

  const splashEl  = document.getElementById("splash");
  const barEl     = document.getElementById("splashBar");
  const statusEl  = document.getElementById("splashStatus");

  let splashDone  = false;
  let stepsTotal  = 4; // 4 APIs
  let stepsDone   = 0;

  function splashStep(label) {
    stepsDone++;
    const pct = Math.round((stepsDone / stepsTotal) * 100);
    barEl.style.width = pct + "%";
    statusEl.className = "splash-status";
    statusEl.textContent = label;
    if (stepsDone >= stepsTotal) splashDismiss(300);
  }

  function splashDismiss(delay = 0) {
    if (splashDone) return;
    splashDone = true;
    setTimeout(() => {
      splashEl.classList.add("hidden");
    }, delay);
  }

  // Timeout de seguranÃ§a: 5s no mÃ¡ximo
  setTimeout(() => splashDismiss(), SPLASH_MAX_MS);

  // Barra animada enquanto aguarda (cresce atÃ© 80% antes dos dados chegarem)
  let autoTick = 0;
  const autoInterval = setInterval(() => {
    autoTick += 2;
    if (autoTick >= 78 || splashDone) { clearInterval(autoInterval); return; }
    barEl.style.width = autoTick + "%";
  }, 80);

  async function prefetchAll() {
    try {
      const [a, b, c, d] = await Promise.all([
        jsonp(WEB_APP_URL + "?action=listRequests"),
        jsonp(WEB_APP_URL + "?action=listPoints"),
        jsonp(WEB_APP_URL + "?action=listVolunteers"),
        jsonp(WEB_APP_URL + "?action=listVistorias")
      ]);

      const ts = Date.now();
      if (a.ok) sessionStorage.setItem("ajudajf_requests",  JSON.stringify({ ts, data: a.data }));
      if (b.ok) sessionStorage.setItem("ajudajf_points",    JSON.stringify({ ts, data: b.data }));
      if (c.ok) sessionStorage.setItem("ajudajf_vols",      JSON.stringify({ ts, data: c.data }));
      if (d.ok) sessionStorage.setItem("ajudajf_vistorias", JSON.stringify({ ts, data: d.data }));

      if (a.ok) {
        const open = (a.data || []).filter(r => r.status === "open").length;
        document.getElementById("cntRequests").textContent = open;
        document.getElementById("cntRequests").classList.remove("loading");
        splashStep("Pedidos carregados âœ“");
      }
      if (b.ok) {
        document.getElementById("cntPoints").textContent = (b.data || []).length;
        document.getElementById("cntPoints").classList.remove("loading");
        splashStep("Pontos de doaÃ§Ã£o carregados âœ“");
      }
      if (c.ok) {
        document.getElementById("cntVols").textContent = (c.data || []).length;
        document.getElementById("cntVols").classList.remove("loading");
        splashStep("VoluntÃ¡rios carregados âœ“");
      }
      if (d.ok) {
        const pending = (d.data || []).filter(v => v.status === "pending").length;
        document.getElementById("cntVis").textContent = pending;
        document.getElementById("cntVis").classList.remove("loading");
        splashStep("Vistorias carregadas âœ“");
      }
    } catch {
      // falha silenciosa â€” splash some pelo timeout de 5s
      splashDismiss(500);
    }
  }

  document.addEventListener("DOMContentLoaded", prefetchAll);
</script>

</html>
